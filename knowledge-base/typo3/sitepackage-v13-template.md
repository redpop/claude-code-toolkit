# TYPO3 v13 Sitepackage Template Reference

This document contains the complete reference template for a TYPO3 v13.4 sitepackage as generated by https://get.typo3.org/sitepackage. This serves as the canonical blueprint for creating new TYPO3 sitepackages with Fluid Styled Content.

## Directory Structure

```
sitepackage/
├── Classes/
│   ├── Controller/
│   ├── Domain/
│   │   ├── Model/
│   │   └── Repository/
│   └── ViewHelpers/
├── Configuration/
│   ├── RTE/
│   │   └── Default.yaml
│   ├── Sets/
│   │   └── SitePackage/
│   │       ├── PageTsConfig/
│   │       │   └── BackendLayouts/
│   │       │       └── default.tsconfig
│   │       ├── TypoScript/
│   │       │   ├── config.typoscript
│   │       │   └── page.typoscript
│   │       ├── config.yaml
│   │       ├── page.tsconfig
│   │       ├── settings.yaml
│   │       └── setup.typoscript
├── Resources/
│   ├── Private/
│   │   ├── ContentElements/
│   │   │   ├── Layouts/
│   │   │   ├── Partials/
│   │   │   └── Templates/
│   │   ├── Language/
│   │   │   ├── locallang.xlf
│   │   │   ├── locallang_be.xlf
│   │   │   └── locallang_db.xlf
│   │   └── PageView/
│   │       ├── Layouts/
│   │       │   └── Default.html
│   │       ├── Pages/
│   │       │   └── Default.html
│   │       └── Partials/
│   │           └── Content.html
│   └── Public/
│       ├── Css/
│       │   ├── layout.css
│       │   └── rte.css
│       ├── Fonts/
│       ├── Icons/
│       │   ├── Extension.svg
│       │   └── favicon.ico
│       ├── Images/
│       │   └── BackendLayouts/
│       │       └── default.png
│       └── JavaScript/
│           └── main.js
├── composer.json
├── ext_conf_template.txt
├── ext_emconf.php
├── ext_localconf.php
├── ext_tables.php
└── README.md
```

## File Contents

### composer.json

```json
{
  "name": "{vendor}/{package}",
  "type": "typo3-cms-extension",
  "description": "",
  "homepage": "https://{vendor-url}",
  "license": ["GPL-2.0-or-later"],
  "keywords": ["TYPO3 CMS"],
  "require": {
    "typo3/cms-core": "^13.4",
    "typo3/cms-rte-ckeditor": "^13.4",
    "typo3/cms-fluid-styled-content": "^13.4"
  },
  "autoload": {
    "psr-4": {
      "{VendorNamespace}\\{PackageNamespace}\\": "Classes/"
    }
  },
  "extra": {
    "typo3/cms": {
      "extension-key": "{extension-key}"
    }
  }
}
```

### ext_emconf.php

```php
<?php

$EM_CONF[$_EXTKEY] = [
    'title' => '{extension-title}',
    'description' => '',
    'category' => 'templates',
    'constraints' => [
        'depends' => [
            'typo3' => '13.4.0-13.4.99',
            'fluid_styled_content' => '13.4.0-13.4.99',
            'rte_ckeditor' => '13.4.0-13.4.99',
        ],
        'conflicts' => [
        ],
    ],
    'autoload' => [
        'psr-4' => [
            '{VendorNamespace}\\{PackageNamespace}\\' => 'Classes',
        ],
    ],
    'state' => 'stable',
    'uploadfolder' => 0,
    'createDirs' => '',
    'clearCacheOnLoad' => 1,
    'author' => '{author-name}',
    'author_email' => '{author-email}',
    'author_company' => '{author-company}',
    'version' => '1.0.0',
];
```

### ext_localconf.php

```php
<?php

defined('TYPO3') or die('Access denied.');

// Add default RTE configuration
$GLOBALS['TYPO3_CONF_VARS']['RTE']['Presets']['{extension-key}'] = 'EXT:{extension-key}/Configuration/RTE/Default.yaml';
```

### ext_tables.php

```php
<?php

defined('TYPO3') or die('Access denied.');
```

### Configuration/Sets/SitePackage/config.yaml

```yaml
name: {vendor}/{package}
label: '{extension-title}'
dependencies:
  - typo3/fluid-styled-content
  - typo3/fluid-styled-content-css
```

### Configuration/Sets/SitePackage/setup.typoscript

```typoscript
@import './TypoScript/'
```

### Configuration/Sets/SitePackage/settings.yaml

```yaml
styles:
  templates:
    layoutRootPath: "EXT:{extension-key}/Resources/Private/ContentElements/Layouts/"
    partialRootPath: "EXT:{extension-key}/Resources/Private/ContentElements/Partials/"
    templateRootPath: "EXT:{extension-key}/Resources/Private/ContentElements/Templates/"

page:
  pageview:
    paths: "EXT:{extension-key}/Resources/Private/PageView/"

  meta:
    viewport: "width=device-width, initial-scale=1"
    robots: "index,follow"
    apple-mobile-web-app-capable: "no"
    compatible: "IE=edge"

  tracking:
    google:
      trackingID: ""
      anonymizeIp: "1"

config:
  no_cache: "0"
  removeDefaultJS: "0"
  admPanel: "1"
  prefixLocalAnchors: "all"
  headerComment: "build by get.typo3.org/sitepackage"
  sendCacheHeaders: "1"
```

### Configuration/Sets/SitePackage/page.tsconfig

```tsconfig
@import './PageTsConfig/BackendLayouts/'

RTE {
    default {
        preset = {extension-key}
    }
}

TCEFORM {
    pages {

    }
    tt_content {

    }
}

TCEMAIN {

}
```

### Configuration/Sets/SitePackage/PageTsConfig/BackendLayouts/default.tsconfig

```tsconfig
#
# BACKENDLAYOUT: DEFAULT
#
mod {
    web_layout {
        BackendLayouts {
            default {
                title = LLL:EXT:{extension-key}/Resources/Private/Language/locallang_be.xlf:backend_layout.default
                config {
                    backend_layout {
                        colCount = 1
                        rowCount = 1
                        rows {
                            1 {
                                columns {
                                    1 {
                                        name = LLL:EXT:{extension-key}/Resources/Private/Language/locallang_be.xlf:backend_layout.column.normal
                                        colPos = 0
                                        identifier = main
                                    }
                                }
                            }
                        }
                    }
                }
                icon = EXT:{extension-key}/Resources/Public/Icons/BackendLayouts/default.svg
            }
        }
    }
}
```

### Configuration/Sets/SitePackage/TypoScript/config.typoscript

```typoscript
################
#### CONFIG ####
################
config {
    absRefPrefix = auto
    no_cache = {$config.no_cache}
    uniqueLinkVars = 1
    pageTitleFirst = 1
    linkVars = L
    prefixLocalAnchors = {$config.prefixLocalAnchors}
    renderCharset = utf-8
    metaCharset = utf-8
    doctype = html5
    removeDefaultJS = {$config.removeDefaultJS}
    inlineStyle2TempFile = 1
    admPanel = {$config.admPanel}
    debug = 0
    cache_period = 86400
    sendCacheHeaders = {$config.sendCacheHeaders}
    intTarget =
    extTarget =
    disablePrefixComment = 1
    index_enable = 1
    index_externals = 1
    index_metatags = 1
    headerComment = {$config.headerComment}

    // Disable Image Upscaling
    noScaleUp = 1

    // Compression and Concatenation of CSS and JS Files
    compressJs = 0
    compressCss = 0
    concatenateJs = 0
    concatenateCss = 0
}
```

### Configuration/Sets/SitePackage/TypoScript/page.typoscript

```typoscript
##############
#### PAGE ####
##############
page = PAGE
page {
    typeNum = 0
    shortcutIcon = EXT:{extension-key}/Resources/Public/Icons/favicon.ico

    10 = PAGEVIEW
    10 {
        paths {
            0 = EXT:{extension-key}/Resources/Private/PageView/
            1 = {$page.pageview.paths}
        }
        dataProcessing {
            10 = files
            10 {
                references.fieldName = media
            }
            20 = menu
            20 {
                levels = 2
                includeSpacer = 1
                as = mainnavigation
            }
            30 = page-content
        }
    }

    meta {
        viewport = {$page.meta.viewport}
        robots = {$page.meta.robots}
        apple-mobile-web-app-capable = {$page.meta.apple-mobile-web-app-capable}

        X-UA-Compatible = {$page.meta.compatible}
        X-UA-Compatible {
            attribute = http-equiv
        }
    }

    includeCSSLibs {

    }

    includeCSS {
        {extension-key}_layout = EXT:{extension-key}/Resources/Public/Css/layout.css
    }

    includeJSLibs {

    }

    includeJS {

    }

    includeJSFooterlibs {

    }

    includeJSFooter {
        {extension-key}_scripts = EXT:{extension-key}/Resources/Public/JavaScript/main.js
    }
}
```

### Configuration/RTE/Default.yaml

```yaml
imports:
  - { resource: "EXT:rte_ckeditor/Configuration/RTE/Processing.yaml" }
  - { resource: "EXT:rte_ckeditor/Configuration/RTE/Editor/Base.yaml" }
  - { resource: "EXT:rte_ckeditor/Configuration/RTE/Editor/Plugins.yaml" }

editor:
  config:
    contentsCss: "EXT:{extension-key}/Resources/Public/Css/rte.css"

    stylesSet:
      - { name: "Lead", element: "p", attributes: { "class": "lead" } }

    toolbarGroups:
      - { name: styles, groups: [format, styles] }
      - { name: basicstyles, groups: [basicstyles] }
      - { name: paragraph, groups: [list, indent, blocks, align] }
      - "/"
      - { name: links, groups: [links] }
      - { name: clipboard, groups: [clipboard, cleanup, undo] }
      - { name: editing, groups: [spellchecker] }
      - { name: insert, groups: [insert] }
      - { name: tools, groups: [table, specialchar] }
      - { name: document, groups: [mode] }

    format_tags: "p;h1;h2;h3;h4;h5;pre"

    justifyClasses:
      - text-left
      - text-center
      - text-right
      - text-justify

    extraPlugins:
      - justify

    removePlugins:
      - image

    removeButtons:
      - Anchor
      - Underline
      - Strike
```

### Resources/Private/PageView/Layouts/Default.html

```html
<ul>
  <f:for each="{mainnavigation}" as="mainnavigationItem">
    <li class="{f:if(condition: mainnavigationItem.active, then:'active')}">
      <a
        href="{mainnavigationItem.link}"
        target="{mainnavigationItem.target}"
        title="{mainnavigationItem.title}"
      >
        {mainnavigationItem.title}
      </a>
      <f:if condition="{mainnavigationItem.children}">
        <ul>
          <f:for each="{mainnavigationItem.children}" as="child">
            <li class="{f:if(condition: child.active, then:'active')}">
              <a
                href="{child.link}"
                target="{child.target}"
                title="{child.title}"
              >
                {child.title}
              </a>
            </li>
          </f:for>
        </ul>
      </f:if>
    </li>
  </f:for>
</ul>
<f:render section="Main" />
```

### Resources/Private/PageView/Pages/Default.html

```html
<f:layout name="Default" />
<f:section name="Main">
  <div style="background-color: yellow; padding: 0.5em 1em;">
    <dl>
      <dt>Template file</dt>
      <dd>
        <code
          >packages/{extension-key}/Resources/Private/PageView/Pages/Default.html</code
        >
      </dd>
      <dt>Backend Configuration</dt>
      <dd>
        <code
          >packages/{extension-key}/Configuration/Sets/SitePackage/PageTsConfig/BackendLayouts/default.tsconfig</code
        >
      </dd>
    </dl>
  </div>

  <f:render partial="Content" arguments="{records: content.main.records}" />
</f:section>
```

### Resources/Private/PageView/Partials/Content.html

```html
<f:for each="{records}" as="record">
  <f:cObject
    typoscriptObjectPath="{record.mainType}"
    data="{record}"
    table="{record.mainType}"
  />
</f:for>
```

### Resources/Private/Language/locallang.xlf

```xml
<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<xliff version="1.0">
    <file source-language="en" datatype="plaintext" original="messages" date="{date}">
        <header>
            <authorName>{author-name}</authorName>
            <authorEmail>{author-email}</authorEmail>
        </header>
        <body>
        </body>
    </file>
</xliff>
```

### Resources/Private/Language/locallang_be.xlf

```xml
<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<xliff version="1.0">
    <file source-language="en" datatype="plaintext" original="messages" date="{date}">
        <header>
            <authorName>{author-name}</authorName>
            <authorEmail>{author-email}</authorEmail>
        </header>
        <body>
            <trans-unit id="backend_layout.default">
                <source>Default</source>
            </trans-unit>
            <trans-unit id="backend_layout.column.stage">
                <source>Stage</source>
            </trans-unit>
            <trans-unit id="backend_layout.column.normal">
                <source>Normal</source>
            </trans-unit>
            <trans-unit id="backend_layout.column.right">
                <source>Right</source>
            </trans-unit>
        </body>
    </file>
</xliff>
```

### Resources/Private/Language/locallang_db.xlf

```xml
<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<xliff version="1.0">
    <file source-language="en" datatype="plaintext" original="messages" date="{date}">
        <header>
            <authorName>{author-name}</authorName>
            <authorEmail>{author-email}</authorEmail>
        </header>
        <body>
        </body>
    </file>
</xliff>
```

### Resources/Public/Css/layout.css

```css
/* Main Layout CSS - Add your styles here */
```

### Resources/Public/Css/rte.css

```css
/* RTE Editor Styles */
.lead {
  font-size: 1.25rem;
  font-weight: 300;
}
```

### Resources/Public/JavaScript/main.js

```javascript
console.log("WE LOVE TYPO3");
```

## Key Features of this Template

### 1. **TYPO3 v13 Site Sets**

- Uses the new Site Sets configuration system introduced in TYPO3 v13
- Configuration split into `config.yaml`, `settings.yaml`, and TypoScript files
- Dependencies managed through Site Sets

### 2. **PAGEVIEW Content Object**

- Uses the new PAGEVIEW content object for rendering pages
- Supports structured data processing
- Clean separation of layout and content

### 3. **Modern Composer Setup**

- PSR-4 autoloading
- Proper dependency management
- Extension-key in extra section

### 4. **Fluid Styled Content Integration**

- Full integration with fluid_styled_content
- Content element templates structure ready
- RTE configuration with custom preset

### 5. **Backend Layouts**

- TSconfig-based backend layout configuration
- Localized labels
- Clean column structure

### 6. **Multi-language Support**

- XLF files for frontend and backend translations
- Proper localization structure

## Installation Process

1. **Create the sitepackage structure** in `packages/{vendor}/{package}/`
2. **Add to composer.json** repositories:
   ```json
   {
     "repositories": [
       {
         "type": "path",
         "url": "packages/{vendor}/{package}"
       }
     ]
   }
   ```
3. **Require via Composer**: `composer require {vendor}/{package}:@dev`
4. **Activate extension**: `vendor/bin/typo3 extension:setup`
5. **Configure Site Set** in site configuration

## Customization Points

- Replace all `{vendor}`, `{package}`, `{extension-key}` placeholders
- Customize backend layouts in `PageTsConfig/BackendLayouts/`
- Add custom TypoScript in `TypoScript/` directory
- Extend RTE configuration in `Configuration/RTE/Default.yaml`
- Add custom content elements in `Resources/Private/ContentElements/`
- Implement custom ViewHelpers in `Classes/ViewHelpers/`

## Best Practices

1. **Use Site Sets** for configuration management
2. **Keep TypoScript modular** - split into logical files
3. **Use constants** for configurable values
4. **Implement responsive layouts** from the start
5. **Follow TYPO3 coding standards** for PHP classes
6. **Use XLF files** for all text labels
7. **Version control** everything except generated files
